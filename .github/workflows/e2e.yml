name: end to end testing
run-name: Running End to End testing on ${{ github.ref }} -> ${{ github.sha }}
on:
  workflow_dispatch:
    
jobs:
  tests:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@4
        with:
          ref: ${{ github.ref }}
      - name: setup tests
        working-directory: ./test
        run:
          npm install
      - name: launch application
        run: docker compose up -d
      - name: api test
        working-directory: ./test
        run: |
          passed=""
          echo "# Test Results! 🚀" >> $GITHUB_STEP_SUMMARY
          node api-test.js || passed="false"
          if [[ -n "$passed" ]]; then
            echo "API test failed! ❌" >> $GITHUB_STEP_SUMMARY
          else
            echo "API test passed! ✅" >> $GITHUB_STEP_SUMMARY
          fi
      - name: ui test
        working-directory: ./test
        run: |
          passed=""
          node browser-test.js || passed="false"
          if [[ -n "$passed" ]]; then
            echo "Browser test failed! ❌" >> $GITHUB_STEP_SUMMARY
          else
            echo "Browser test passed! ✅" >> $GITHUB_STEP_SUMMARY
          fi
          